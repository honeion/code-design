
## 회원가입 시나리오 

### Client ------------------------> Server
              회원가입 요청

                       1. member 엔티티 연속화
                       2. 외부 시스템 이메일 호출
                       3. 회원가입 쿠폰 발급
              
              회원가입 응답
### Client <------------------------ Server


## 회원 가입 Flow   
> 회원생성  
-> 메일발송  
-> 쿠폰발행  

### 시스템의 강결한 결합 문제를 이벤트 기반으로 조치한다

> 회원가입  
> -> 회원 가입 쿠폰 발행  
> -> 회원 가입 완료 이벤트 발행  
> -> 회원 가입 이벤트 리스너 동작    
> -> 회원 가입 이메일 전송

- TransactionalEventListener 활용하여 Commit된 내역만 수신하여 트랜잭션 문제 해결
  변경 전
  - 1.회원생성->메일발송->쿠폰발행  
  변경 후
  - 1.회원생성->쿠폰발행->이벤트발행
  - 2.이벤트수신->메일발송



## 주문 시나리오

### Client ------------------------> Server
              주문 요청

                       1. order 엔티티 연속화
                       2. 해당 주문의 장바구니 제거
              
              주문 요청 응답
### Client <------------------------ Server

- 장바구니에서 삭제되는 부분이 실패하더라도 주문은 잘 되어야한다는 것
- 롤백 되어버리거나, 제거가 오류로 오래걸려서 주문 요청 자체의 응답이 느려지는 상태면(동기호출) 
문제가 되기 때문에 비동기 방식으로 조치